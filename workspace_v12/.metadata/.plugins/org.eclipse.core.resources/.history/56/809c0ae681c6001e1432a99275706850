#include <msp430.h>
#include <driverlib.h>
#include <Board.h>



void setupPWM() {
    // Assuming PWM on LED1 pin as an example. Adjust based on your setup.
    P1DIR |= GPIO_PIN_LED1; // Set the pin to output direction

    // Adjust these lines based on your MSP430 model specifics
    // Example adjustment for models using P1SEL0 and P1SEL1
    #ifdef P1SEL0
    P1SEL0 |= GPIO_PIN_LED1; // Select PWM function (adjust as needed)
    #endif
    #ifdef P1SEL1
    P1SEL1 &= ~GPIO_PIN_LED1; // Ensure correct function is selected
    #endif

    // Configure Timer_A for PWM
    TA0CTL = TASSEL_2 + MC_1; // SMCLK as source, Up mode
    TA0CCTL1 = OUTMOD_7; // Reset/Set mode
    TA0CCR0 = 1000 - 1; // PWM Period
    TA0CCR1 = 500; // Initial duty cycle 50%
}

void setFanSpeed(unsigned int speed) {
    if (speed > 100) speed = 100;
    TA0CCR1 = (TA0CCR0 + 1) * speed / 100 - 1;
}

int main(void) {
    WDTCTL = WDTPW | WDTHOLD; // Stop watchdog timer
    setupPWM(); // Setup PWM for fan control

    // Correct loop declaration
    unsigned int speed; // Declare speed variable outside the loop
    while(1) {
        for(speed = 0; speed <= 100; speed += 10) {
            setFanSpeed(speed);
            __delay_cycles(1000000); // Delay to observe the change
        }
    }
}

}



